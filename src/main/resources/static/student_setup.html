<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Setup Profile</title>
    <style>
        body {
          font-family: Arial, sans-serif;
          display: flex;
          justify-content: center;
          align-items: center;
          height: 100vh;
          background: #eef2f7;
          margin: 0;
        }
        .form-box {
          background: white;
          padding: 30px;
          border-radius: 8px;
          box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
          width: 320px;
        }
        input {
          width: 100%;
          padding: 10px;
          margin: 8px 0;
          border: 1px solid #ddd;
          border-radius: 4px;
        }
        button {
          width: 100%;
          padding: 10px;
          background: #28a745;
          color: white;
          border: none;
          border-radius: 4px;
          font-size: 16px;
          cursor: pointer;
        }
        button:hover {
          background: #1e7e34;
        }
    </style>
</head>
<body>

<div class="form-box">
    <h2>Student Setup</h2>
    <!-- âœ… Add form element -->
    <form id="studentSetupForm">
        <input id="name" placeholder="Full Name" required>
        <input id="usn" placeholder="USN" required>
        <input id="dob" type="date" placeholder="Date of Birth" required>
        <input id="mentorName" placeholder="Mentor Name" required>
        <input id="mentorId" placeholder="Mentor ID" required>
        <input id="department" placeholder="Department" required>
        <input id="year" placeholder="Academic Year" type="number" required>
        <button type="submit">Submit</button>
    </form>
</div>

<script>
    document.getElementById("studentSetupForm").addEventListener("submit", async (e) => {
      e.preventDefault();

      const payload = {
        name: document.getElementById("name").value.trim(),
        usn: document.getElementById("usn").value.trim(),
        dob: document.getElementById("dob").value,
        mentorName: document.getElementById("mentorName").value.trim(),
        mentorId: document.getElementById("mentorId").value.trim(),
        department: document.getElementById("department").value.trim(),
        year: parseInt(document.getElementById("year").value)
      };

      if (!payload.name || !payload.usn || !payload.dob || !payload.mentorName || !payload.mentorId || !payload.department || !payload.year) {
        alert("All fields are required!");
        return;
      }

      try {
        const res = await fetch("/api/student/setup", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(payload)
        });

        if (res.ok) {
          alert("Profile setup completed successfully!");
          window.location = "student_dashboard.html";
        } else {
          const error = await res.text();
          alert("Failed to setup profile: " + error);
        }
      } catch (err) {
        console.error(err);
        alert("Something went wrong. Please try again.");
      }
    });
</script>

</body>
</html>
