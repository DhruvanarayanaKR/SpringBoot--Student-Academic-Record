<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Student Dashboard</title>
    <style>
        :root{
          --bg:#f4f7fb;
          --card:#ffffff;
          --accent:#1976d2;
          --muted:#6b7280;
          --radius:10px;
        }
        *{box-sizing:border-box}
        body{
          margin:0;
          font-family:Inter, "Segoe UI", Roboto, Arial, sans-serif;
          background:var(--bg);
          color:#0f172a;
        }
        .topbar{
          height:64px;
          display:flex;
          align-items:center;
          justify-content:space-between;
          padding:10px 20px;
          background:linear-gradient(90deg,var(--card),transparent);
          border-bottom:1px solid rgba(15,23,42,0.04);
        }
        .brand{display:flex;align-items:center;gap:12px}
        .logo{
          width:44px;height:44px;border-radius:8px;background:var(--accent);
          display:flex;align-items:center;justify-content:center;color:white;font-weight:700;
        }

        .container{max-width:1000px;margin:18px auto;padding:20px;display:flex;flex-direction:column;gap:18px}

        .grid{
          display:grid;
          grid-template-columns:repeat(auto-fit,minmax(220px,1fr));
          gap:16px;
        }
        .card{
          background:var(--card);
          border-radius:var(--radius);
          padding:18px;
          box-shadow:0 8px 28px rgba(11,20,40,0.06);
          display:flex;flex-direction:column;gap:10px;
        }
        .title{font-size:16px;font-weight:700}
        .desc{color:var(--muted);font-size:13px}
        .actions{display:flex;gap:8px;margin-top:8px}
        .link{
          text-decoration:none;color:var(--accent);font-weight:700;padding:8px;border-radius:8px;border:1px solid rgba(25,118,210,0.08)
        }
        .btn{
          padding:10px 12px;border-radius:8px;border:0;cursor:pointer;font-weight:600;background:var(--accent);color:white;
        }
    </style>
</head>
<body>

<div class="topbar">
    <div class="brand">
        <div class="logo">ST</div>
        <div>
            <div class="title">Student Portal</div>
            <div class="muted" style="font-size:12px">Manage Your Academic Data</div>
        </div>
    </div>
    <div style="display:flex;align-items:center;gap:12px">
        <div id="studentName" class="muted">Loading...</div>
        <button onclick="logout()" style="padding:8px 12px;border-radius:8px;border:0;background:#ef4444;color:white;cursor:pointer">Logout</button>
    </div>
</div>

<div class="container">

    <div class="grid">
        <div class="card">
            <div class="title">First-Time Setup</div>
            <div class="desc">Fill your personal & mentor details</div>
            <div class="actions">
                <a class="link" href="student_setup.html">Start</a>
            </div>
        </div>

        <div class="card">
            <div class="title">Marks & Grades</div>
            <div class="desc">Add / View semester-wise marks</div>
            <div class="actions">
                <a class="link" href="student_marks.html">Open</a>
            </div>
        </div>

        <div class="card">
            <div class="title">Activity Points</div>
            <div class="desc">Upload extracurricular activity points</div>
            <div class="actions">
                <button class="btn" disabled>Coming Soon</button>
            </div>
        </div>

        <div class="card">
            <div class="title">Achievements</div>
            <div class="desc">Add certificates & accolades</div>
            <div class="actions">
                <button class="btn" disabled>Coming Soon</button>
            </div>
        </div>
    </div>

</div>

<script>
    async function loadStudent() {
      try {
        const res = await fetch('/api/student/profile');
        if (!res.ok) throw new Error();
        const student = await res.json();

        // Redirect if first-time setup (missing details)
        if (!student.department || !student.mentorId) {
          window.location = 'student_setup.html';
          return;
        }

        document.getElementById('studentName').textContent =
            "Hi " + (student.name || student.username);
      } catch {
        document.getElementById('studentName').textContent = "Hi Student";
      }
    }

    async function logout() {
      await fetch('/api/auth/logout');
      window.location = 'index.html';
    }

    loadStudent();
</script>


</body>
</html>
