<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Achievements</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
:root {
  --bg:#f4f7fb;
  --card:#ffffff;
  --accent:#1976d2;
  --muted:#6b7280;
  --radius:12px;
}

* {
  box-sizing: border-box;
}

body {
  margin: 0;
  font-family: Inter, Arial, sans-serif;
  background: var(--bg);
}

.container {
  max-width: 900px;
  margin: 40px auto;
  padding: 20px;
}

.card {
  background: var(--card);
  padding: 28px;
  border-radius: var(--radius);
  box-shadow: 0 8px 28px rgba(0,0,0,0.08);
  margin-bottom: 32px;
}

h2 {
  margin-top: 0;
  margin-bottom: 20px;
}

/* ===== FORM GRID ===== */
.form-grid {
  display: grid;
  grid-template-columns: 1fr;
  gap: 16px;
}

.form-group {
  display: flex;
  flex-direction: column;
}

label {
  font-weight: 600;
  margin-bottom: 6px;
}

input, select, textarea {
  padding: 12px;
  border-radius: 8px;
  border: 1px solid #d1d5db;
  font-size: 14px;
  width: 100%;
}

textarea {
  resize: vertical;
  min-height: 80px;
}

/* ===== DATE ROW ===== */
.date-row {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 16px;
}

/* ===== BUTTON ===== */
button {
  margin-top: 16px;
  padding: 12px 20px;
  background: var(--accent);
  color: white;
  border: none;
  border-radius: 8px;
  font-size: 15px;
  font-weight: 600;
  cursor: pointer;
  width: fit-content;
}

/* ===== ACHIEVEMENT LIST ===== */
.achievement {
  border-left: 4px solid var(--accent);
  padding-left: 16px;
  margin-bottom: 18px;
}

.achievement h4 {
  margin: 0 0 4px 0;
}

.muted {
  color: var(--muted);
  font-size: 13px;
}

/* ===== RESPONSIVE ===== */
@media (max-width: 600px) {
  .date-row {
    grid-template-columns: 1fr;
  }
}

.delete-btn {
  background: #dc2626;
  color: white;
  border: none;
  padding: 6px 10px;
  border-radius: 6px;
  font-size: 13px;
  cursor: pointer;
}

.delete-btn:hover {
  background: #b91c1c;
}


</style>
</head>

<body>

<div class="container">

  <!-- ADD ACHIEVEMENT -->
  <div class="card">
    <h2>Add Achievement</h2>

    <div class="form-grid">
      <div class="form-group">
        <label>Title</label>
        <input id="title" placeholder="Hackathon / Event name">
      </div>

      <div class="form-group">
        <label>Category (Optional)</label>
        <select id="category">
          <option value="">Select category</option>
          <option>Hackathon</option>
          <option>Sports</option>
          <option>Technical</option>
          <option>Cultural</option>
          <option>Other</option>
        </select>
      </div>

      <div class="form-group">
        <label>Description (Optional)</label>
        <textarea id="description" placeholder="Describe your achievement"></textarea>
      </div>

      <div class="date-row">
        <div class="form-group">
          <label>From</label>
          <input type="date" id="fromDate">
        </div>

        <div class="form-group">
          <label>To</label>
          <input type="date" id="toDate">
        </div>
      </div>

      <button onclick="saveAchievement()">Save</button>
    </div>
  </div>

  <!-- LIST -->
  <div class="card">
    <h2>My Achievements</h2>
    <div id="list">Loading...</div>
  </div>

</div>

<script>
async function saveAchievement() {
  const body = {
    title: title.value,
    category: category.value,
    description: description.value,
    fromDate: fromDate.value || null,
    toDate: toDate.value || null
  };

  await fetch('/api/student/achievements', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    credentials: 'include',
    body: JSON.stringify(body)
  });

  loadAchievements();
}

async function loadAchievements() {
  const res = await fetch('/api/student/achievements', {
    credentials: 'include'
  });

  const list = document.getElementById('list');

  if (!res.ok) {
    list.innerHTML = "Please login again";
    return;
  }

  const data = await res.json();

  if (data.length === 0) {
    list.innerHTML = "No achievements added yet";
    return;
  }

  list.innerHTML = data.map(a => `
	  <div class="achievement">
	    <div style="display:flex;justify-content:space-between;align-items:start">
	      <div>
	        <h4>${a.title}</h4>
	        <div class="muted">${a.category || 'Other'}</div>
	        <div class="muted">
	          ${a.fromDate || ''} ${a.toDate ? 'â€“ ' + a.toDate : ''}
	        </div>
	        <div>${a.description || ''}</div>
	      </div>
	
	      <button class="delete-btn" onclick="deleteAchievement(${a.id})">
	        Delete
	      </button>
	    </div>
	  </div>
	`).join('');

}

async function deleteAchievement(id) {
	  if (!confirm("Are you sure you want to delete this achievement?")) return;

	  await fetch(`/api/student/achievements/${id}`, {
	    method: "DELETE",
	    credentials: "include"
	  });

	  loadAchievements();
	}


loadAchievements();
</script>

</body>
</html>
